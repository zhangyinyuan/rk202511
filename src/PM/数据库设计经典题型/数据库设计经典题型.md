# 数据库设计经典题型
## 2017年下半年 题目

【需求分析结果】
该系统的部分功能及初步需求分析的结果如下 ：
（1）M 公司旗下有业务部、策划部和其他部门。部门信息包括部门号、部门名、主管、联系电话和邮箱号；每个部门只有一名主管，只负责管理本部门的工作，且主管参照员工关系的员工号；一个部门有多名员工，每名员工属于且仅属于一个部门。
（2）员工信息包括员工号、姓名、职位、联系方式和薪资。职位包括主管、业务员、 策划员等。业务员负责受理用户申请，设置受理标志。一名业务员可以受理多个用户申请，但一个用户申请只能由一名业务员受理。
（3）用户信息包括用户号、用户名、银行账号、电话、联系地址。用户号唯一标识用户信息中的每一个元组。
（4） 用户申请信息包括申请号、用户号、会议日期、天数、参会人数、地点、预算和受理标志。申请号唯一标识用户申请信息中的每一个元组，且一个用户可以提交多个申请，但一个用户申请只对应一个用户号。
（5）策划部主管为已受理的用户申请制定会议策划任务。策划任务包括申请号、任务明细和要求完成时间。申请号唯一标识策划任务的每一个元组。一个策划任务只对应一个己受理的用户申请，但一个策划任务可由多名策划员参与执行，且一名策划员可以参与执行多项策划任务。
【概念模型设计】
根据需求阶段收集的信息，设计的实体联系图（不完整）如图 2-1 所示。

![f5806056e75845e7be70b72a94b2a17a_](../../../../work-record/src/img/f5806056e75845e7be70b72a94b2a17a_.png)

---

【关系模型设计】
 部门（部门号，部门名，部门主管，联系电话，邮箱号）
 员工（员工号，姓名，（a），联系方式，薪资）
 用户（用户名，（b），电话，联系地址）
 用户申请（申请号，用户号，会议日期，天数，参会人数，地点，受理标志，（c））
 策划任务（申请号，任务明细，（d）） 
 执行（申请号，策划员，实际完成时间，用户评价）

【问题1】（5分）
根据问题描述，补充五个联系，完善图2-1的实体联系图。联系名可用联系1、联系2、联系3、联系4和联系5，联系的类型为1:1、1:n和m:n（或1:1、1:*和*:*）。
【问题2】（4分）
根据题意，将关系模式中的空（a）~（d）补充完整，并填入答题纸对应的位置上。
【问题3】（4分）
给出“用户申请”和“策划任务”关系模式的主键和外键。
【问题4】（2分）
请问“执行”关系模式的主键为全码的说法正确吗？为什么？

---

---

## **答案与解析**

【问题1】
1.联系1：部门和员工，1:n
2.联系2：业务员和用户申请，1:n
3.联系3：用户和用户申请，1:n
4.联系4：策划员和策划任务，n:m
5.联系5：策划任务和用户申请，1:1
或（联系5：部门和主管，1:1）
【问题2】
a.职位，部门号
b.用户号，银行账号
c.预算费用，业务员（员工号）
d.要求完成时间，主管号
【问题3】
用户申请：主键：申请号 外键：用户号，业务员
策划任务：主键：申请号 外键：策划员工号，主管员工号
【问题4】
不正确
All-key关系模型的所有属性组成该关系模式的候选码，称为全码。即所有属性当作一个码。若关系中只有一个候选码，且这个候选码中包含全部属性，则该候选码为全码。
实际完成时间和用户评价为非主属性。

---

## 归纳总结：

1. 关系模式填空，两部分组成
   1. 题目给出的属性
   2. 联系，将1方的主键加入到*方
2. 题目要求给5个联系，就一定要给出5个， 不要只给4个
3. 第一小问的关系模型设计附带了一些联系。首尾呼应

**重在检查，防止漏掉属性**

---

---

### 不需要补全题目没要求的子实体

> [画图. 题目明确指出画出联系, 即便题干中有子实体在图中没出现. 只要所在的联系与没出现的实体没关系, 都不用补全实体](https://ebook.qicoder.com/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%B8%88/notes/2020%E8%BD%AF%E8%AE%BE%E4%B8%8B%E5%8D%88%E6%A1%88%E4%BE%8B%E9%A2%98.html#%E7%AC%AC-2-%E9%A2%98)

![image-20250516165619544](../../../../work-record/src/img/image-20250516165619544.png)

---

### 两个实体有联系, 要把单个关系的主键加入到另外一个实体中

> 特别注意这一点. 会导致扣分. 补全属性错了. 会导致第3问也一起错. 错一道就是错两道

![image-20250516170235625](../../../../work-record/src/img/image-20250516170235625.png)

---

最后一问,存在某种情况, 问你有什么问题, 需要怎么解决?

回答模板:

题目抄一遍,(一般都是重复记录某个关系模式的属性),会导致冗余,插入,删除,更新等异常,需要进行拆解,拆解后的关系模式是:

原关系模式抄一遍,去掉一对多的关系,

新的关系模式写一遍. 主要主键和外键不要丢

---

## 2018上半年 第2题

阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。
【说明】
     某海外代购公司为扩展公司业务，需要开发一个信息化管理系统。请根据公司现有业务及需求完成该系统的数据库设计。
【需求描述】
    （1）记录公司员工信息。员工信息包括工号、身份证号、姓名、性别和一个手机号，工号唯一标识每位员工，员工分为代购员和配送员。
    （2）记录采购的商品信息。商品信息包括商品名称、所在超市名称、采购价格、销售价格和商品介绍，系统内部用商品条码唯一标识每种商品。一种商品只在一家超市代购。
    （3）记录顾客信息。顾客信息包括顾客真实姓名、身份证号（清关缴税用）、一个手机号和一个收货地址，系统自动生成唯一的顾客编号。
    （4）记录托运公司信息。托运公司信息包括托运公司名称、电话和地址，系统自动生成唯一的托运公司编号。
    （5）顾客登录系统之后，可以下订单购买商品。订单支付成功后，系统记录唯一的支付凭证编号，顾客需要在订单里指定运送方式：空运或海运。
    （6）代购员根据顾客的订单在超市采购对应商品，**一份订单**所含的**多个商品**可能由**多名代购员**从**不同超市**采购。
    （7）采购完的商品交由配送员根据顾客订单组合装箱，然后交给托运公司运送。托运公司按顾客订单核对商品名称和数量，然后按顾客的地址进行运送。

【概念模型设计】
      根据需求阶段收集的信息，设计的实体联系图（不完整）如图2－1所示。

![9apJthjpgK](../../../../work-record/src/img/9apJthjpgK.png)

【逻辑结构设计】
      根据概念模型设计阶段完成的实体联系图，得出如下关系模式（不完整）：
      员工（工号，身份证号，姓名，性别，手机号）
      商品（条码，商品名称，所在超市名称，采购价格，销售价格，商品介绍）
      顾客（编号，姓名，身份证号，手机号，收货地址）
      托运公司（托运公司编号，托运公司名称，电话，地址）
      订单（订单ID，（a），商品数量，运送方式，支付凭证编号） **从2-1实体联系图可以得到答案**
      代购（代购ID，代购员工号，（b））**从2-1实体联系图可以得到这里缺少订单ID，从题干得知还缺少商品条码**
      运送（运送ID，配送员工号，托运公司编号，订单ID，发运时间）  

【问题1】（3分）
 根据问题描述，补充图2-1的实体联系图。
 【问题2】（6分）
 补充逻辑结构设计结果中的（a）、（b）两处空缺。

【问题3】（6分）
为方便顾客，允许**顾客**在系统中保存**多组**收货地址。请根据此需求，增加“顾客地址”**弱实体**，对图2-1进行补充，**并修改“运送”关系模式**。（解析题目要求：需要做到两点：1.增加**弱实体**并添加联系；2.修改运送关系模式）

---

试题答案：【问题1】
 ![img](https://ebook.qicoder.com/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%B8%88/tiku/uploadfiles/2018-05/d3190e834e1f49c0873a731f94f4ad8e_.png)
 【问题2】
 （a）商品条码，顾客编号
 （b）订单ID，商品条码
 【问题3】
![img](https://ebook.qicoder.com/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%B8%88/images/shiti/2020-10/540/djRvYaLYp5.png)

运送关系模式**增加属性：顾客地址**
运送（运送ID，配送员工号，托运公司编号，订单ID，顾客地址，发运时间） ，主键是运送ID，外键是配送员工号，托运公司编号，订单ID，顾客地址

